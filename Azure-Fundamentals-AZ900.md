# AZ900 Azure Fundamentals

## Cloud Concepts
- On-demand / Self-service
- Can access anywhere in the world
- Rapid elasticity
- Only Pay for what you use (resource based/time based)
- Benefits if using Cloud Services
    - High Availability
        - ability of system to respond to users (% of time)
    - Scalability
        - abilty of system/website to handle grown of users/demand/requests
    - Elasticity
        - ability to automatically grow/shrink resources based on demand
    - Agility
        - ability to respond to changes in the market or environment
        - can test things cheaply/experiment
    - Fault Tolerance
        - abiltiy of a system to handle faults like power, networking or hardware failures
    - Disaster Recovery
        - ability of a system toi recover from a failure within a period of time, and how much data is lost
    - Econonmy of Scale
        - Since Azure owns and runs so much hardware, they can do so more efficiently, and pass on the savings to the customer
    - CapEx vs. OpEx
        - CapEx is money invested (upfront) in assets (like computers or other hardware) that return investment over time
            - Value reduces over time
        - OpEx is the cost of doing business on daily bases, ongoing expenses
            - As needed spend
            - immediate billing
            - deduct expence from tax bill in same year (no depreciation)
    - Global Reach 
        - can use resources in various regions around the world
    - Customer latency capabilities
        - Can deploy applications closer to users, reduces latency
    - Security
        - Majority of security rquirements are managed by vendor instead of customer 
    - Consumption-based model
        - Pay per time used (minute, hour)
        - Pay for resources used (size, number)
        - Can predict costs

- Paradigms for hosting apps
    - On-Premises (Manage)
        - Manage everything, include networking, compute resources purchase and powering
    - IaaS (Host)
        - Infrastructure such as VMs, networking, LBs, firewalls that you can get in a Cloud environment
    - PaaS (Develop)
        - Provider runs your application, don't have access to hardware, but you provide the software/code
    - SaaS (Consume)
        - Software available to use within the cloud, only configuration access only
        - Subscription based cost
![Compare paradigms](https://stack247.files.wordpress.com/2015/05/azure-on-premises-vs-iaas-vs-paas-vs-saas.png)
    
- Cloud Types
    - Public
        - Computing services offered over the public internet
        - anyone can sign up
        - publicly accessible
        - Personal users, organisations
    - Private
        - Computing services offered to only select users
        - internal or corporate cloud
        - can be hosted on own or leased hardware
        - "Cloud" means the self-service access to resources
        - Still need to purchase infrastructure
        - need skills to manage the DC as well as the cloud
    - Hybrid
        - Combination of public and private clouds
        - scale private infrastructure to the cloud
        - Greatest flexibility - can keep difficult to migrate apps on-prem, new or modern apps to cloud

## Azure Architecture
- Regions
    - collection of DCs
    - Some service regionally independent
    - 58 regions
    ![Azure Regions](https://azurecomcdn.azureedge.net/cvt-92799112b92ce1432ee2e938fe2233012be6a469ece7c4743b538ebd039395e4/images/shared/regions-map-large.svg)
    - Region Pairs 
        - A region that is linked with another region in the same geography (at least 300 miles apart)
        - Some services can replicate
        - Patch/update one region at a time
        - Can failover from one region to the other when there's an outage
- Availability Sets
    - Separate Domains in the AZ to ensure things like hardware failures or patches don't take out the whole AZ at once
    - Update Domains
        - digital level domains 
    - Fault Domains
        - physical level domain
- Availability Zones
    - Datacentre, separated by distance
    - 3 AZs per Region
    - Allows for maximum amount of availability
    - Not available in all regions
- Availability options:
    - Single VM (SLA 99.9%)
    - Availability Set (SLA 99.95%)
    - Availabilty Zones (SLA 99.99%)
    - Region Pairs (Full DR)
- Resource Groups
    - Way of organisiging resources
    - Can perform operations on resource groups
    - Container for resources
    - Resources can only be in one RG
    - Can secure at RG level, using RBAC
- Geographies
    -  discrete market typically containing two or more regions that preserves data residency and compliance boundaries

    ![Resource Hierachy](https://docs.microsoft.com/en-us/azure/cloud-adoption-framework/ready/azure-setup-guide/media/organize-resources/scope-levels.png)
- Azure Resource Manager
    - Model of deployments
    - API layer for functionality provisioning and configuring ALL services/features/resources
    - Can use ARM templates to build stacks consistently multiple times
- Benefits / Usage of core Azure architectural components
    - Put resources close to users

## Compute
- Virtual Machines
    - Not a real machine, normally part of a real machine using virtualisation software to appear as a single/individual machine
    - Is your machine to install/control
    - IaaS - including networking
    - Tooling to manage VMs
    - Bluepirnts
        - Used to configure the entire stack of resources to be used
    - Azure recommendations
    - Many different OS types
        - Defined by Image (HyperV images)
    - Pricing
        - hourly
        - More compute/memory, more cost
    - Windows or Linux
    - Hypervisor run on host machine, allows VM to run on part of a machine
- Scale Sets
    - Group of identical, load balanced VMs
    - Controlled by a scaling policy, e.g. when CPU is > X%, add another VMs or scheduled
    - Way of ensuring High Availability, if a machine stops, app keeps working
    - Can manage multiple (identical) VMs easily w/ the same config
    - Auto scaling, run what you need, up or down
    - Elasticity - add/remove machines
- App Service
    - Upload code / software, Azure will provision required hardware and run it for us as a web service
    - no need to provision infrastructure
    - PaaS
    - Automatic scalability 
    - Integrates with many other Azure servives
- Functions
    - serverless
    - Can edit in browser
    - meant for small pieces of code execution
    - 1M executions free
    - upload code, no configuration of software needed
- Azure Container Instances 
    - fast/easy way to deploy containers
    - containers
        - package entire software environment into container
        - Virtualised environment, reference to OS
        - Unlike VM, don't manage OS
    - reduce overheads on promoting software/changes through environments
    - ACI 
        - quickest way to get a container created (under a minute)
        - Not great scalability
        - Supports Docker containers
- Azure Kubernetes Service
    - like ACI, but has ability to scale
    - based on Google's Kubernetes
        - complete orchestration service for containers with distributed architectures and large volumes of containers

## Networking
- Virtual Network (VNet)
    - Network to connect resources (VMs, functions, etc.) to to use them/connect to other services
    - done via software
- Load Balancers
    - Network LB
        - Can be used for any traffic (internal or external)
        - traffic controlled via some defined (user or default) algorithm
- VPN Gateway
    - create private link between own network and virtual network
    - requires connection on both sides
    - provided by Azure
    - blocks public traffic
- Application Gateway
    - Load balancer that operates at http request level (application LB)
    - Can direct traffic based on URL, query params, http headers, etc.
- Content Delivery Network
    - servers not controlled by us
    - serves content (static files) to users at Edge locations, generally closer to users than the origin
    - removes traffic from origin(s)

## Storage
- Storage account can be replicated based on user choice, default is Geo Redundant Storage
- Blob
    - used for storing large amount of unstructured data
    - Block blobs
    - Page blobs
    - Append blobs
- Disk
    - persistant disk
    - allows data to be stored persistently and attached as a virtual hard disk
    - can mount them to a VM
    - options
        - SSD, high IOPs, low latency
- File
    - uses SMB / REST protocol
    - allows multiple VMs to R/W the files
    - Access from anywhere
    - Secure access
- Archive
    - Cold, infrequently accessed data, cheap storage, slow/expensive access
    - normally for recovery
- Table
    - NoSQL data store
    - Dynamic scaling based on load
    - scales to PBs
    - Fast key/value lookup
- Queue
    - Store / retreive messages
    - highly scalable
    - process messages asynchronously

## Database
- CosmosDB
    - NoSQL database
    - Globally availably
    - Very fast 
    - PaaS DB offering
- Azure SQL DB
    - PaaS DB offering
    - Managed service
    - Scales easily
    - Relational DB
- Azure DB for MySQL
    - Managed version of MySQL (open source DB)
- Azure DB for PostgreSQL
    - Managed version of PostgreSQL (open source DB)
    - MySQL compatible
- Azure DB Migration service
    - Service to help migrate existing DB (on prem, other cloud) to Azure
- Can deploy DBs onto existing Azure DB servers or create new DBs

## Marketplace
- Service where Microsoft or external vendors can sell their Azure products and solutions
- Simple catalog based portal

## Azure Solutions
- IoT
    - IoT Central 
        - a SaaS solution that can help ease the costs and effort of developing a whole IoT solution from scratch.
        - SaaS solution
    - IoT Hub 
        - provides a managed and secure backend for millions of IoT devices.
        - bi-directional message hub
        - Supports Millions of records per seconds
        - Paas Solution
- Big Data / Analytics
    - Synapse Analytics (formerly SQL Data Warehouse) 
        - Reporting service, large reports/data store
        - Integrated heavily with Power BI
    - HDInsight
        - Hadoop managaged service by Azure
    - Azure Databricks
        - Centalised service to pull in data from many services, perform transfromations, create reports
- Artificial Intelligence
    - Machine Learning service
        - Vision API, Speech API, etc.
        - an ML model defines what you want your machine learning implementation to learn
    - Machine Learning Studio
        - Drag-and-Drop visual workspace to build/test/deploy ML solutions
        - no need to write code (but can)
- Serverless
    - Azure Functions
        - upload code to be run, no server configuration needed
        - performance guaranteed
    - Logic Apps
        - tie functions together
    - Event Grid
- DevOps
    - Azure Devops
        - dev collaboration, pipelines, repos, kanban board, automated testing, load testing
    - Azure DevTest Labs
        - create environments on the fly - minimise cost
- Benefits/Outcomes of using Azure solutions
- Tools
    - Azure Portal
        - Manually configure using click configurations
    - Azure PowerShell
        - Use the SDK for Powershell to connect to Azure from PS to perform management tasks
    - Azure CLI
        - based on bash, mainly for Linux, connect to Azure
    - Cloud Shell
        - Can run CLI or Powershell in the browser from the portal
- Azure Adviser
    - Analyses your use of resources using AI/ML
    - Offer proactive, actionable recommendations on:
        - High Availability
        - Security
        - Performance
        - Cost

## Security
- Network Security Groups
    - Series of rule that allow (filter) inbound or outbound traffic
    - Both Inbound and Outbound rules
    - Prioritised rules
    - e.g. block all traffic except on a particular IP range
    - Enabled at a subnet level
- Application Security Groups
    - Can apply resource based rules (e.g. All VMs, all SQL Servers etc.)
    - Reuse server level security across many VMs (port/IP filtering)
- User Defined Routes
    - Specify an exact path that some traffic needs to travel over your network
    - e.g. force all internet traffic via a firewall device, or for to ensure all outbound traffic goes via a corporate network before going out to the internet
- Azure Firewall
    - Analyse traffic being directed to it, and either reject or allow it based on a pattern
    - Built in HA
    - Firewall as a Service
    - Web Application Firewall
        - Can recognise patterns at http level, look for common attack signature such as XSS, SQL injection and reject, otherwise load balance
- Azure DDoS Protection
    - Basic
        - Monitoring
        - Mitigation for L3/L4 attacks
        - L7 protection with Gateway WAF
        - Globally deployed
    - Standard
        - Basic features +
        - tuned policies in our Virtual Network
        - Logging/Alerting & Telemetry
        - Resource cost scale protection
- Security Solution appropriateness
    - All virtual network subnets should use NSGs
        - make the rules fairly tight
        - i.e. lock the doors that are never used
    - DDoS only use as needed or after attacked, cost can be prohibative
    - Application Gateway with WAF
        - Mainly useful for high traffic enterprise applications
    - Security through layers (Defence In Depth)
        - Shared Responsability maps to Shared Security, if we manage the layer, we need to secure the layer
        - ensure multiple layers of security exists in case of single layer breaches
            - Data - i.e. virtual network enpoint - restrict access to data to a particular VNet
            - Application - i.e. API Management
            - Compute - i.e. Limit Remote Desktop access, Windows Update
            - Network - i.e. NSG, use subnets, used for different tiers of the app, deny by default
            - Perimeter - i.e. DDoD, firewalls
            - Identity & access - i.e. Azure AD + MFA
            - Physical - i.e. Door locks and key cards
    - Use Azure AD instead of building your own, SaaS vs. IaaS
    - Use MFA, more secure
- Security Tools
    - Physical vs. Digital
        - Physical - computer logged into application, no access to Azure DCs
        - Security responsibility maps to shared security architecture
    - Azure Security Center
        - Monitoring service for Azure (and on-prem) services
        - Dashboard of policy/compliance
        - Different tiers (free/standard)
        - provides security recommendations
        - Automaticsllty applies your chosen security policies to new services you provision
    - Azure Security Center usage scenarios
        - Detect - review first indication (dashboard)
        - Assess - can find more info
        - Diagnose - e.g. follow the remediation steps described by Security Center in that particular security alert.
    - Key Vault
        - Authorised access to secrets store
        - Can import or create
        - All secrets in Azure should be managed in Azure Key Vault
        - Secrets management
        - Key management
        - Certificate management
        - Storing secrets backed by Hardware Security Modules (HSMs)
        - Can import keys, signed keys
    - Azure Information Protection (AIP)
        - classify and (optionally) protect its documents and emails by applying labels.
        - labels can map to access permissions (e.g. Confidential, Private, Public) -
    - Azure Advanced Threat Protection (ATP)
        - identifies, detects, and helps you investigate advanced threats, compromised identities, and malicious insider actions directed at your organization
            - e.g. if a user that only logs in from internal network suddenly logs in as this person from outside the network, can react to it
        - Reduces attack surface (e.g. stops brute force attacks)
        - ATP Portal
            - Can modify dashboard to see relevant data
        - ATP Sensor
        - ATP Cloud Service

## Identity Services
- Authentication and Authorization
    - Authentication is a user proving who they are, user ID and password (Auth-N)
    - Authorisation is ensuring a user is permitted to perform an action (Auth-Z)
    - Least Priviliges - Enasure minimum user granted as are needed
- Azure Active Directory
    - Designed for web technologies primarily
    - Identity as a Service - IDaaS
    - MS's preferred solution for ID managment
    - Mange users/groups/roles
    - Enables SSO - use company username/password to allow access to all applications
    - Can synchronise with the corporate AD, allow users/passwords to be used in the AAD
    - Not the same as MS Active Directory
- Azure Multi-Factor Authentication
    - Users are forced to use a second method of authentication
    - E.g. Username/Password/Mobile
    - Made of:
        - Something you are (voice, face, thumbprint)
        - Something you know (username, password, secret question)
        - Something you have (phone, app, ATM card)

## Governance
- Azure Policy
    - create rules across specicfic RGs, Subscriptions, etc.
    - evaluate compliance to the rules
    - E.g. 
        - Require SQL Server 12.0
        - Apply tag and its default value
        - Allowed locations
        - Specific resource types
    - Custom policies with JSON
    - Initiatives
        - groups of policies, apply to Resource/RG/Subscriptions, etc.
- Role-Based Access Control (RBAC)
    - Recommended authentication mechanism
    - Create roles that represent the common task of the job
    - Many pre-built roles
    - make role permissions fine-grained, can add users to multiple roles if greater permissions needed
    - Used to grant access to Azure, rather than granting access to users directly, assign/remove users from role
- Locks
    - Tie down resources to flag they can't be changes
    - Read Only lock - can't modify
    - Cannot delete lock - can't delete
    - To perform modify/delete, delete the lock first
    - Can use RBAC to control who can access locks
- Azure Advisor security assistance
    - runs every few hours, makes recommendations about what you can do to improve security in account
    - results in security center dashboard
- Azure Blueprints
    - subscription template, roles/policies defined
    - use this to create new subscriptions

## Monitoring & Reporting
- Tags
    - Assign tags to resources (Key-Value pairs) to identify resources
    - can use for billing filtering (roll-up the billing)
    - Tags at RG level not inherited by resources
    - Maximum 15 tags (512 char Key, 256 char Value)
- Azure Monitor
    - Monitoring service to get telemerty from Azure (or other cloud/on-prem) environments, logfiles or other metrics
    - App Data
    - OS level data
    - Azure resource monitoring
    - Azure subscription monitoring
    - Azure tenant monitoring
    - Can install monitor agent to collect operational data from VM
    - Can use Monitor metrics to trigger autoscaling
- Azure Service Health
    - place to go to get personalised guidance and support/notifications anout our services
    - Status 
        - provides overview of Azure service's health
    - Service Health 
        - not customer specific
        - cusotmisables dashboard for service state in out region
        - service issues
        - planned maintenence
    - Azure Resource Health 
        - customer/application resource specific
        - helps you diagnose and obtain support when an Azure service issue affects your resources
- Use cases and benefits of Azure Monitor and Azure Service Health
    - Analyse
    - Respond
    - Visualise
    - Integrate

## Privacy, Compliance and Trust
- Compliance (91 compliance requirements that Azure meets) 
    - go to full list (https://docs.microsoft.com/en-us/microsoft-365/compliance/offering-home?view=o365-worldwide)
    - GDPR 
        - General Data Protection Regulation
        - EU citizens get more control over their data
        - Applies to any company that handles EU citizens' data
    - ISO 
        - International Organization for Standardization
        - Azure in compliance with many of the tech related ones 
        - e.g. ISO 9001:2015 Quality Management Systems
    - NIST 
        - National Institute of Standards and Technology
        - CyberSecurity Framework (CSF)
        - Need to be audited to be compliant
    - PCI - Payments/credit-card information standard
- Microsoft Privacy Statement
    - https://privacy.microsoft.com/en-us/privacystatement
    - how microsoft collects your data, stores, protects, handles and what they do with it
- Trust center
    - details of how it implements security, privacy, compliance offerings, policies, features, and practices at Microsoft
    - microsofts stance on compliance/privacy etc.
- Service Trust Portal
    - download audit reports produced by external auditors 
    - gain insight from Microsoft-authored operational reports
    - pen test reports, blueprints, whitepapers, compliance guides
- Compliance Manager
    - Manage our compliance activities and repositort for compliance
    - risk assessment tool
    - workflow based
    - see how well you rate against compliance standards
- Azure Government
    - separate instance of Azure
    - physical isolation from non-US government deployments 
    - screened US personnel, no public access
    - specifically for US Government
    - separate region for Department of Defence (DoD) again
    - different standards compared to public
- Azure China
    - specifically for China
    - operated by 21Vianet
    - separate implementation of Azure services
    - disconnected from normal Azure, data retained in China

## Pricing
- Subscriptions
    - access control boundaries
    - billing boundaries
    - offer types
        - dev/test
        - enterprise
        - VS professional
        - Free
    - Management groups
        - Groups of Subscriptions (or further management groups)
        - MGs not mandatory, subscriptions are
        - Way of simplifying organisational structure
        - Heirachial manner of organising subs
    - Accounts can have multiple subscriptions, or one subscriptions
    - Can have subscriptions for departments (i.e. Finance, Marketing), or environment (Dev, Prod)
    - Single user account can be set up to access multiple subscriptions
- Cost management
    - Purchase options
        - enterprise - EA - commitment to spend
            - large spend, negotiated, custom prices
        - Web direct - sign up online (Pay as you go)
        - Cloud solution providers (Partners, billed via customer's CSP)
    - Azure Free account
        - $200 credit for 30 days
        - after that, heaps of free services for 12 months
        - some services always free
    - Cost Factors
        - resource types (bigger performance, higher cost)
        - ingress/egress traffic (egress traffic has cost, inter-Zone egress has cost)
        - services (IaaS < PaaS < SaaS)
        - locations (some locations charge more for same service/resource)
        - Time running (per second billing means billing stops when VM is stopped)
    - Reserved Instances (VMs)
        - Discounts for 1 or 3 year commitments
    - Bandwidth
        - Outbound data (5GB free)
        - Inbound free
    - Zones for billing purposes (geographical grouping of regions)
        - Inbound data free
        - Outbound data cost based on location (3 Zones)
    - Pricing calculator
        - put expected resources into calculated
        - estimate only
        - Export and share
    - Total Cost of Ownership (TCO) calculator
        - compare current on-prem data centre (total cost) vs. cloud migrated architecure (total cost)
        - on-prem has power, security, rent, server costs, cooling, backup, networking, maintenance, skilled labour
        - cloud has less requirements, per unit price covers this
    - Cost Minimisation best practices
        - performing cost analysis
        - spending limits 
        - alerts when billing exceeds an expected level
        - Use Azure policy to restrict access to higher level servers (tailor to environment)
        - use autoscaling to expand/contract number of resources running to match use
        - quotas
        - Auto-shutdown dev/qa resources
        - use cool/archive storage where possible (archive 90% cheaper)
        - using tags to identify cost owners, ensure we can contact owners to know what resources are actually being used
        - Azure reservations - discounts for 1 or 3 year VM commitments (RIs)
        - Azure Advisor - follow cost reduction recomendations, right size VMs, downsize storage
    - Azure Cost Management
        - free tool to analyse spending
        - break down by 
            - resource type
            - time period
        - set budgets
        - schedule / create reports
        
## Support
- Levels
    - Basic
        - free and included in all plans
    - Developer ($29 / month)
        - For trial and non-production environments
    - Standard ($100 / month)
        - production environments
    - Professional Direct ($1000 / month)
        - Get a delivery manager
        - business critical
        - Max 2 hour response time for Cat B incidents
    - Premier ("contact us for price")
        - Get a TAM
        - multiple products, including Azure
        - Fastest response time
    ![Support Plans](https://cdn.substack.com/image/fetch/c_limit,f_auto,q_auto:good/https%3A%2F%2Fbucketeer-e05bbc84-baa3-437e-9518-adb32be77984.s3.amazonaws.com%2Fpublic%2Fimages%2Fdc1924b6-32bb-4f9b-84b0-83b0a502614d_1172x816.png)
- Support Tickets
    - Raise via Help + Support area in portal
    - Select issue type
- Support Channels
    - Phone / Email (depending on plan)
    - Developer forums
- Knowledge Centre
    - FAQ for different services
- Service Level Agreements (SLA)
    - (Financial) guarantee of the performance of a product
    - Different SLAs for different resources
    - Composite SLAs
        - Combination of SLAs for overall application
        - multiply SLA together, more services in critical path, lower SLA
        - Add redundancy, increase SLA
    - determine appropriate SLA for an app
- Service Lifecycle
    - Services/features are released in a lifecycle, previewed first, offered to specific customers first, then beta (for all), then GA
    - Announcements as service/feature moves through the different stages on updates page (RSS page)
    - Previews (services may not release to GA)
        - Private
        - Public
    - General Availability
    - Monitor feature/service updates 

## Exam Preparation
- https://learn.acloud.guru/course/az-900-microsoft-azure-fundamentals
- https://www.udemy.com/course/az900-azure/
- https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE3VwUY
